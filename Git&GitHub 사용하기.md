# Git  & GitHub 사용하기

Git을 좀 더 편리하게 사용할 수 있도록 도와주는 Git 클라이언트 프로그램은 GitHub Desktop, 토터스 깃, 소스트리 등이 있지만 여기서는 **근-본**을 공부하기 위해 커맨드 라인 인터페이스를 사용 한다. Git의 기능은 대표적으로 버전관리, 백업, 협업이 있고 이때 사용하는 명령어들을 살펴보자.

```bash
git log --oneline
git log --oneling --branches
```



## 1. 환경설정

깃은 버전을 저장할 때, 버전을 만든 사용자 정보도 저장하기 때문에 사용자 정보를 입력하여야 한다.

```bash
git config --global user.name "zkdlu"
git config --global user.eamil "zkdlu159951@gmail.com"
```

이제 깃을 사용하기 위해 디렉토리를 하나 만들어 깃 초기화를 해준다.

```bash
mkdir test
cd test
git init
```

test라는 디렉토리를 만들어 git을 사용하기 위해 초기화 해준다.

### 번외. .gitigrnore

버전관리 중인 디렉토리 안에 관리 하지 않을 특정 파일 또는 디렉토리가 있다면 .gitignore 파일을 만들어 목록을 지정하여야 한다.

> mynote.txt
>
> temp/
>
> .jpg

## 2. 버전관리

Git이 파일의 수정 내역을 기록하는 과정은 다음과 같다.

- 작업트리

  파일 수정, 저장 등의 작업을 하는 디렉터리로 작업 디렉터리라고도 한다. 

- 스테이지(Stage)

  스테이지는 버전으로 만들 파일이 대기하는 곳이다. 스테이징 영역이라고 부르기도 한다. 작업트리에서 작업한 파일 중 버전으로 남길 파일을 스테이지로 넘겨준다.

  ```bash
  git add hello.txt 로 해당 파일을 스테이지로 추가 하거나
  git add . 로 디렉토리 내 전체 파일을 스테이지로 추가 할 수 있다.
  ```

  ```bash
  git status 로 상태를 확인 한다.
  ```

  

- 저장소

  스테이지에서 대기하고 있던 파일들을 버전으로 만들어 저장하는 곳이다.

  ```bash
  git commit -m "message" 로 스테이지에 올라온 파일을 저장소로 추가한다.
  ```

  ```bash
  git log 로 버전이 제데로 만들어졌는지 확인이 가능하다.
  ```


### 2.1. 변경사항 확인하기

작업트리에서 작업한 내용이 저장소에 있는 최근 버전과 비교해서 어떤 부분이 다른지 찾기 위해서는 git diff를 사용한다.

```bash
git diff
```

### 2.2 작업 되돌리기

- 작업 트리에서 수정한 파일 되돌리기

  파일을 수정한 뒤 소스가 정상적으로 동작하지 않는 등의 이유로 수정한 내용을 취소하고 가장 초신 버전 상태로 되뎔랴아 할 때가 있다. 이 때 사용하는 명령어는 checkout이다.

  ```bash
  git checkout --되돌릴파일
  ```

  > checkout으로 되돌린 파일은 다시 원래대로 복구 못한다.

- 스테이징 되돌리기

  수정된 파일을 스테이징 했을 때, 스테이징을 취소하는 방법

  ```bash
  git reset HEAD 되돌릴파일
  ```

- 최신 커밋 되돌리기

  수정된 파일을 스테이징하고 커밋까지 했을 때, 가장 마지막 커밋을 취소하는 방법

  ```bash
  git reset HEAD^
  ```

  > HEAD^는 현재  HEAD가 가리키는 브랜치의 최신 커밋을 가리킨다.

- 특정 커밋으로 되돌리기

  특정 버전으로 되돌린 다음 그 이후 버전을 삭제 할 수 있다.

  git log를 보면 커밋마다 해시값을 가지고 있는데 이 값을 가져온다.

  ```bash
  git reset --hard 복사한 커밋 해시
  ```

  이 명령어는 해당 커밋 내용을 복사하는것이 아닌 해당 커밋을 최신 커밋으로 만들기 때문에 이후에 추가된 커밋들은 삭제 된다.

- 커밋 삭제하지 않고 되돌리기

  커밋으로 되돌릴 때 수정했던 것을 삭제해도 되나면 git reset을 사용하면 되지만 나중에 사용할 것을 대비해서 커밋을 되돌리더라고 취소한 커밋을 남겨둘 때 revert 명령어를 사용한다.

  ```bash
  git revert 복사한 커밋 해시
  ```

### 2.3. 브랜치

브랜치에 대한 자세한 내용은 검색해보자.

- 브랜치 목록 생성 및 확인

  ```bash
  git branch -> branch 목록을 보여준다.
  git branch 새 브랜치명 -> 새로운 branch를 생성한다.
  ```

- 브랜치 이동하기

  ```bash
  git checkout 브랜치명
  ```

- git log 활용하기

  ```bash
  git log --oneline : 커밋을 한줄로 확인 가능
  git log --oneline --branches : 각 브랜치의 커밋을 같이 확인 가능
  git log --oneline --branches --graph : 브랜치와 커밋의 관계를 그래프형태로 표시
  ```

- 브랜치 사이의 차이점 알아보기

  ```bash
  git log A브랜치..B브랜치
  ```

  A브랜치를 기준으로 B브랜치와 비교한다.

- 브랜치 병합하기

  ```bash
  git checkout master
  git merge A브랜치
  ```

  A브랜치의 내용을 master브랜치로 병합한다.

  > 같은 문서의 같은 줄을 수정했을 때 병합을 하게 되면 브랜치 충돌(Conflict)이 나게 된다. 
  >
  > 충돌이 생긴 문서는 자동으로 병합 될 수 없으므로 사용자가 직접 충돌 부분을 해결한 뒤 커밋해야 한다.

  ```
  <<<<<< HEAD
  (현재 브랜치에서 수정한 내용)
  =======
  (병합 할 브랜치에서 수정한 내용)
  >>>>>>> A브랜치
  ```
  
  충돌이 난 파일은 위 처럼 된다. 내용을 원하는 내용으로 수정하고 해당 파일을 스테이지에 올리고 커밋한다.
  
- 병합이 끝난 브랜치 삭제하기

  ```bash
  git branch -d 삭제할 브랜치 명
  ```

  

## 3. 백업

지역 저장소의 내용을 원격 저장소로 저장하도록 하자.  원격 저장소는 GitHub가 있다.

### 3.1. GitHub

- 원격 저장소에 연결하기

  ```bash
  git remote add origin "원격 저장소 주소"
  ```

- 원격 저장소에 파일 올리기

  ```bash
  git push origin master : master브랜치를 push
  git push origin A브랜치 : A브랜치를 push
  ```

  > 처음 push할 경우 --set-upstream  옵션을 사용 해야한다.

- 원격 저장소에서 파일 내려받기

  원격 저장소에 있는 소스파일을 다른 사용자가 수정했거나 GitHub 사이트에서 직접 커밋하면 지역 저장소와 차이가 생긴다. 이럴 때는 원격 저장소와 지역 저장소를 지역 저장소의 상태를 같게 만들기 위해 원격 저장소의 소스를 지역 저장소로 가져온다.

  ```bash
  git pull 원격저장소명 브랜치명
  git pull origin master
  ```

  > git pull = git fetch + git merge

  

## 4. 협업

- 원격 저장소 복제하기

  ```bash
  git clone 원격 저장소 주소
  git clone -b 브랜치명 원겨 저장소 주소
  ```

- 원격 브랜치 정보 가져오기

  원격 저장소의 정보를 가져온다. pull의 경우 원격 저장ㅇ소의 커밋을 가져와 무조건 지역 저장소에 합치게 되는데 fetch 명령어의 경우 원격 브랜치에 어떤 변화가 있는지 그 정보만 가져온다. 다른 사람이 수정한 소스를 한번 보고 지역 저장소와 합치고 싶을 때는 pull 대신 fetch를 사용한다.

  ```bash
  git fetch
  ```

  git status로 확인하면 현재 브랜치가 origin/master과의 커밋 차이가 나오게 된다.

  패치해서 가져온 최신 커밋을 살펴보고 싶다면 FETCH_HEAD 브랜치로 체크아웃해서 확인한다.

  ```bash
  git checkout FETCH_HEAD
  ```

### 4.1. 풀 리퀘스트 (Pull Request)

- 작성 예정